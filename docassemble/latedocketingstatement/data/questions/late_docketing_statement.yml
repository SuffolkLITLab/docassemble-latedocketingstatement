---
include:
  - docassemble.AssemblyLine:al_package.yml
  - docassemble.ALMassachusetts:al_massachusetts.yml
  - docassemble.MassAccess:massaccess.yml
  - docassemble.MassAppealsCourt:appeals-basic-questions.yml
  #- docassemble.AffidavitofIndigencyMAVC:affidavit_body.yml
---
metadata:
  title: Motion for Leave to Late Docket Appeal
  short title: Late Docketing Statement
  comment: Late Docketing Statement
  tags:
    - BE-00-00-00-00
    - BE-04-00-00-00
    - ED-00-00-00-00
    - ES-00-00-00-00
    - FA-00-00-00-00
    - FA-07-00-00-00
    - HE-00-00-00-00
    - HO-00-00-00-00
    - IM-00-00-00-00
    - MO-00-00-00-00
    - RI-10-00-00-00
---
mandatory: True
comment: |
  This contains metadata that will not be overwritten if this YAML file is included in another file. Each file gets its own key in the interview_metadata dictionary. Most keys are not currently used at runtime, other than "allowed courts".
code: |
  interview_metadata
  if not defined("interview_metadata['late_docketing_statement']"):
    interview_metadata.initializeObject("late_docketing_statement")
    interview_metadata["late_docketing_statement"].update({
      "al_weaver_version": "1.0.2",
      "generated on": "2021-06-08",
      "title": "Appeals Late Docketing Statement",
      "short title": "Late docketing statement",
      "description": "Late docketing statement",
      "original_form": "",
      "allowed courts": [
        "Boston Municipal Court",
        "District Court",
        "Housing Court",
        "Juvenile Court",
        "Land Court",
        "Probate and Family Court",
        "Superior Court",
      ],
      "categories": [
        "BE-00-00-00-00",
        "RI-10-00-00-00",
        "FA-00-00-00-00",
        "ED-00-00-00-00",
        "IM-00-00-00-00",
        "HE-00-00-00-00",
        "HO-00-00-00-00",
        "ES-00-00-00-00",
        "FA-07-00-00-00",
        "MO-00-00-00-00",
        "BE-04-00-00-00",
      ],        
      "logic block variable": "interview_order_late_docketing_statement",
      "attachment block variable": "late_docketing_statement_attachment",
      "typical role": "unknown",
    })
---
code: |
  interview_short_title = "Get a Late Docketing Statement"
---
code: |
  al_form_type = 'appeal'
---
objects:
  - other_parties: ALPeopleList.using(there_are_any=True)
  - users: ALPeopleList.using(there_are_any=True)
  - attorney: ALPeopleList
---
sections:
  - review_late_docketing_statement: Review your answers
---
#################### Interview order #####################
comment: |
  Controls order and branching logic for questions specific to this form
id: interview_order_late_docketing_statement
code: |
  # Set the allowed courts for this interview
  allowed_courts = interview_metadata["late_docketing_statement"]["allowed courts"]
  nav.set_section('review_late_docketing_statement')
  # Below sets the user_role by asking a question.
  # You can set user_role directly instead to either 'plaintiff' or 'defendant'
  user_ask_role #edit
  users[0].name.first
  users[0].email
  users[0].phone_number
  other_parties.gather()
  trial_court
  docket_number
  if knows_docket_number:
    appeals_docket_number
  set_progress(14.29)
  notice_date
  excuse_description
  set_progress(28.57)
  issue_description
  user_date
  motion_delivery
  attorney[0].name.first
  attorney[0].address.address
  set_progress(42.86)
  service_date
  motion_to_dismiss
  
  if has_document: 
    review_doc_upload
 
  set_progress(57.14)
  interview_order_late_docketing_statement = True
---
###################### Main order ######################
comment: |
  This block includes the logic for standalone interviews.
  Delete mandatory: True to include in another interview
mandatory: True
code: |
  al_intro_screen
  interview_order_late_docketing_statement
  signature_date
  # Save anonymized interview statistics (customize the saved data below)
  store_variables_snapshot(data={'zip': users[0].address.zip})
  late_docketing_statement_preview_question
  basic_questions_signature_flow
  late_docketing_statement_download
---
id: docket_number
question: |
  What is the **Trial Court** docket number for your case?
fields: 
  - Docket Number: docket_number
---
id: trial court division 
question: | 
  Select the **Trial Court** department and division where your case was heard.
fields:
  - no label: trial_court
    datatype: combobox
    code: |
      sorted((set([str(y) for y in all_courts.filter_courts(["District Court","Boston Municipal Court", "Probate and Family Court","Housing Court", "Superior Court", "Juvenile Court", "Land Court"])])))  
    hint: To select one start typing or look through the list
---
id: notice_date
question: |
  Date of Notice
subquestion: |
  Provide the date that you received the notice of assembly from the lower court.
fields:
  - "Date of notice": notice_date
    datatype: date
---
id: excuse_description
question: |
  Describe the excusable neglect that resulted in having to file this motion to late docket the appeal. 
subquestion: |
  In other words, describe the reasons why you did not enter your appeal on the Appeals Court docket within 14 days of your receipt of the notice of assembly of the record.
fields: 
  - Description: excuse_description
    input type: area
---
id: issue_description
question: |
  Issue Description
subquestion: |
  To obtain leave to late docket your appeal, in addition to excusable neglect, you must demonstrate that the appeal presents a meritorious issue on appeal--a legal question worthy of judicial investigation and discussion. Describe the meritorious issues that the appeal presents.
fields: 
  - Description: issue_description
    input type: area
---
id: user_number
question: |
  Provide your current contact information...
fields: 
  - Phone Number: user_number
---
id: user_date 
question: |
  Provide the date in which this form was completed. 
subquestion: |
  Please indicate on which day you completed this form.
fields: 
  - Date of Completion: user_date 
    datatype: date
---
id: motion_delivery
question: |
  Select the method of delivery that you have used or will use to provide the required copies of the motion, memorandum and supporting materials to the other party(s)'s attorney(s).
subquestion: |
  You are required to provide a copy of this motion on the other party(s)' attorney(s). If the other party(s) do not have an attorney, you are required to serve a copy on the self-represented party(s). You should not provide a copy of your affidavit of indigency, if any, to anyone except the Appeals Court. 
fields: 
  - Delivery Method: motion_delivery
    input type: dropdown
    choices:
      - E-file and Serve (efilema.com)
      - E-mail
      - Mail
      - Hand Delivery
---
id: attorney[0]
question: |
  List the name and address or email address of each attorney or self-represented party that you have served or will serve with copies of your motion, memorandum and supporting materials.
subquestion: |
  If you are serving more than one attorney or party, you may list more than one in the space provided.
fields: 
  - Attorney Name: attorney[0]
  - Attorney Address: attorney[0].address
---
id: service_date
question: |
  Service Date
subquestion: |
  Select the date on which you have made or will make service.
fields:
  - "Date of Service": service_date
    datatype: date
---
id: Motion to Dismiss
question: |
  Have you been served a **Motion to Dismiss** by the other party? 
yesnomaybe: motion_to_dismiss
---
id: Knows Docket Number
question: |
  Do you have your **Appeals Court** docket number?
fields: 
  - no label: knows_docket_number
    datatype: yesnoradio
---
id: User Date
question: |
  What is the date you signed?
fields:
  - Date: user_date
    datatype: date
---
id: document appendix
question: |
  Upload any relevant documents in support of your request for relief, including any necessary affidavits.
fields:
  - Do you have any documents that you would like to attach to your Motion?: has_document
    datatype: yesnoradio
  - Tap "browse" and choose all of the documents you want to upload at once. You can edit or add additional documents on the next screen.: doc_uploads
    datatype: files
    show if: has_document
    maximum image size: 1024
    image upload type: jpeg    
    accept: |
      "image/*, image/png,.doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/pdf,.pdf"
#validation code: |
  #if has_document and sum(doc_upload.size_in_bytes() for doc_upload in doc_uploads) > (15 * 1024 * 1024):
    #validation_error("Upload a file smaller than 15 MB.")
---
code: | 
  exhibits_attachment[i] = doc_uploads
---
table: doc_uploads.table
rows: doc_uploads
allow reordering: True
columns:
  - File name: showifdef(row_item.attr_name('filename'))
  # - Size: row_item.size_in_bytes() / 1024 / 1024
  - Thumbnail: row_item.show(width="100px")  
delete buttons: True
---
id: review documents
question: |
  Review your documents.
subquestion: |
  Look at the documents below. If you want to change the order, use the arrows
  to move an exhibit up or down in the list. Click "delete" or "add another"
  to change which documents you send to the court.
  
  ${ doc_uploads.table }
  
  ${ doc_uploads.add_action() }
continue button field: review_doc_upload
---
id: preview late_docketing_statement
question: |
  Preview your form before you sign it
subquestion: |
  Here is a preview of the form you will sign on the next page.   
  
  ${ al_court_bundle.as_pdf(key='preview') }
  
  ${ al_user_bundle.as_pdf(key='preview') }

  Click the image to open it in a new tab. Click the "Make changes" button
  to edit your answers.

  ${ action_button_html(url_action('review_late_docketing_statement'), label='Make changes', color='info') }
  
  Remember to come back to this window to continue and sign your form.
continue button field: late_docketing_statement_preview_question    
---
code: |
  signature_fields = []
---
id: late docketing statement review screen
event: review_late_docketing_statement
question: |
  Review your answers
review:
  - Edit: notice_date
    button: |
      **Date of notice**:
      ${ notice_date }
  - Edit: users[0].signature
    button: |
      **E signature**:
      ${ users[0].signature }
  - Edit: defendants
    button: |
      **Defendants**:
      ${ defendants }
  - Edit: excuse_description
    button: |
      **Excuse description**:
      ${ excuse_description }
  - Edit: motion_delivery
    button: |
      **Motion delivery**:
      ${ motion_delivery }
  - Edit: doc_uploads
    button: |
      **Doc upload**:
      ${ doc_uploads }
  - Edit: issue_description
    button: |
      **Issue description**:
      ${ issue_description }
  - Edit: appeals_docket_number
    button: |
      **Appeals docket number**:
      ${ appeals_docket_number }
  - Edit: service_date
    button: |
      **Date of service**:
      ${ service_date }
  - Edit: plaintiff[0]
    button: |
      **Plaintiff[0]**:
      ${ plaintiff[0] }
  - Edit: trial_court
    button: |
      **Trial Court**:
      ${ trial_court }
  - Edit: attorney[0]
    button: |
      **Attorney info**:
      ${ attorney[0] }
  - Edit: other_parties.revisit
    button: |
      **other_parties**

      % for item in other_parties:
        * ${ item }
      % endfor
  - Edit: docket_number
    button: |
      **docket_number**:
      ${ docket_number }
---
continue button field: other_parties.revisit
question: |
  Edit other_parties
subquestion: |
  ${ other_parties.table }

  ${ other_parties.add_action() }
---
table: other_parties.table
rows: other_parties
columns:
  - name: |
      row_item.name.full() if defined("row_item.name.first") else ""
edit:
  - name.first
confirm: True

---
id: download late_docketing_statement
event: late_docketing_statement_download
question: |
  Your form is ready to download.
subquestion: |
  Thank you ${users}. Your form is ready to download and deliver.
  
  View, download and send your form below. Click the "Make changes" button to fix any mistakes.

  ${ action_button_html(url_action('review_late_docketing_statement'), label='Make changes', color='info') }
  
  
  ${ al_user_bundle.download_list_html() }
  

  ${ al_user_bundle.send_button_html(show_editable_checkbox=True) }

progress: 100
---
objects:
  - Post_interview_instructions: ALDocument.using(title="Instructions", filename="late_docketing_statement_next_steps.docx", enabled=True, has_addendum=False)
  - late_docketing_statement_attachment: ALDocument.using(title="Late docketing statement", filename="late_docketing_statement.docx", enabled=True, has_addendum=False)
  - Post_interview_instructions: ALDocument.using(title="Instructions", filename="late_docketing_statement_next_steps.docx", enabled=True, has_addendum=False)
  - late_docketing_statement_attachment: ALDocument.using(title="Late docketing statement", filename="late_docketing_statement.docx", enabled=True, has_addendum=False)
  - macourts: MACourtList.using(courts=['housing_courts','bmc','district_courts','superior_courts','land_court', 'juvenile_courts', 'probate_and_family_courts','appeals_court'])  # this is for lookups
  - exhibits_attachment: ALDocument.using(title='Exhibits', filename='doc_uploads', has_addendum=False)
---
objects:
  - al_user_bundle: ALDocumentBundle.using(elements=[Post_interview_instructions,late_docketing_statement_attachment, exhibits_attachment], filename="late_docketing_statement_package.pdf", title="All forms to download for your records")
  - al_court_bundle: ALDocumentBundle.using(elements=[late_docketing_statement_attachment, exhibits_attachment], filename="late_docketing_statement_package.pdf", title="All forms to download for your records")
---
objects:
  - doc_uploads: DAFileList.using(auto_gather=False, gathered=True)
---
code: |
  if has_document: 
    exhibits_attachment.enabled = True
  else:
    exhibits_attachment.enabled = False
---
attachments:
  - name: Post interview instructions
    filename: Post-interview-instructions     
    variable name: Post_interview_instructions[i]        
    docx template file: late_docketing_statement_next_steps.docx
  - name: late docketing statement attachment
    filename: late_docketing_statement     
    variable name: late_docketing_statement_attachment[i]        
    docx template file: late_docketing_statement.docx
  - name: Post interview instructions
    filename: Post-interview-instructions     
    variable name: Post_interview_instructions[i]        
    docx template file: late_docketing_statement_next_steps.docx
  - name: late docketing statement attachment
    filename: late_docketing_statement     
    variable name: late_docketing_statement_attachment[i]        
    docx template file: late_docketing_statement.docx